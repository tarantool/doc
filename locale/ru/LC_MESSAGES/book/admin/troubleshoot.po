
msgid "Troubleshooting guide"
msgstr "Руководство по разрешению проблем"

msgid "Problem: INSERT/UPDATE-requests result in ER_MEMORY_ISSUE error"
msgstr ""
"Проблема: при выполнении INSERT/UPDATE-запросов возникает ошибка "
"ER_MEMORY_ISSUE"

msgid "**Possible reasons**"
msgstr "**Возможные причины**"

msgid ""
"Lack of RAM (parameters ``arena_used_ratio`` and ``quota_used_ratio`` in "
":ref:`box.slab.info() <box_slab_info>` report are getting close to 100%)."
msgstr ""
"Нехватка памяти (значения параметров ``arena_used_ratio`` и "
"``quota_used_ratio`` из  :ref:`box.slab.info() <box_slab_info>` "
"приближаются к 100%)."

msgid "To check these parameters, say:"
msgstr ""
"Чтобы проверить значения данных параметров, выполните соответствующие "
"команды:"

msgid ""
"$ # attaching to a Tarantool instance\n"
"$ tarantoolctl enter <instance_name>\n"
"$ # -- OR --\n"
"$ tarantoolctl connect <URI>"
msgstr ""
"$ # подключаемся к админ-консоли нужного экземпляра\n"
"$ tarantoolctl enter <instance_name>\n"
"$ # -- ИЛИ --\n"
"$ tarantoolctl connect <URI>"

msgid ""
"-- requesting arena_used_ratio value\n"
"tarantool> box.slab.info().arena_used_ratio\n"
"\n"
"-- requesting quota_used_ratio value\n"
"tarantool> box.slab.info().quota_used_ratio"
msgstr ""
"-- запрашиваем значение arena_used_ratio\n"
"tarantool> box.slab.info().arena_used_ratio\n"
"\n"
"-- запрашиваем значение quota_used_ratio\n"
"tarantool> box.slab.info().quota_used_ratio\n"

msgid "**Solution**"
msgstr "**Решение**"

msgid "Try either of the following measures:"
msgstr "У вас есть несколько вариантов действий:"

msgid ""
"In Tarantool's :ref:`instance file <admin-instance_config>`, increase the"
" value of :ref:`box.cfg{memtx_memory} <cfg_storage-memtx_memory>` (if "
"memory resources are available)."
msgstr ""
"Зайти в :ref:`конфигурационный файл <admin-instance_config>` Tarantool и "
"увеличить значение параметра :ref:`box.cfg{memtx_memory} <cfg_storage-"
"memtx_memory>` (при наличии свободных ресурсов)."

#, python-format
msgid ""
"In versions of Tarantool before 1.10, the server needs to be restarted to"
" change this parameter. The Tarantool server will be unavailable while "
"restarting from .xlog files, unless you restart it using :ref:`hot "
"standby <index-hot_standby>` mode. In the latter case, nearly 100% server"
" availability is guaranteed."
msgstr ""
"В версиях Tarantool'а до 1.10 для изменения данного параметра требуется "
"перезагрузить сервер. При обычной перезагрузке сервер будет недоступен на"
" время старта Tarantool из .xlog-файлов. При перезагрузке в режиме "
"горячего резервирования :ref:`hot standby <index-hot_standby>` "
"гарантирована практически 100%-ная доступность."

msgid "Clean up the database."
msgstr "Провести очистку базы данных."

msgid "Check the indicators of memory fragmentation:"
msgstr "Проверьте, нет ли проблем с фрагментацией памяти:"

msgid ""
"-- requesting quota_used_ratio value\n"
"tarantool> box.slab.info().quota_used_ratio\n"
"\n"
"-- requesting items_used_ratio value\n"
"tarantool> box.slab.info().items_used_ratio"
msgstr ""
"-- запрашиваем значение quota_used_ratio\n"
"tarantool> box.slab.info().quota_used_ratio\n"
"\n"
"-- запрашиваем значение items_used_ratio\n"
"tarantool> box.slab.info().items_used_ratio"

msgid ""
"In case of heavy memory fragmentation (``quota_used_ratio`` is getting "
"close to 100%, ``items_used_ratio`` is about 50%), we recommend "
"restarting Tarantool in the :ref:`hot standby <index-hot_standby>` mode."
msgstr ""
"При высокой степени фрагментации памяти (значение параметра "
"``quota_used_ratio`` приближается к 100%, ``items_used_ratio`` около 50%)"
"  рекомендуется перезапустить Tarantool в режиме горячего резервирования "
":ref:`hot standby <index-hot_standby>`."

msgid "Problem: Tarantool generates too heavy CPU load"
msgstr "Проблема: Tarantool создает большую нагрузку на CPU"

msgid ""
"The :ref:`transaction processor thread <atomic-threads_fibers_yields>` "
"consumes over 60% CPU."
msgstr ""
":ref:`Поток обработки транзакций <atomic-threads_fibers_yields>` "
"нагружает ЦП более чем на 60%."

msgid ""
"Attach to the Tarantool instance with :ref:`tarantoolctl <tarantoolctl>` "
"utility, analyze the query statistics with :ref:`box.stat() "
"<box_introspection-box_stat>` and spot the CPU consumption leader. The "
"following commands can help:"
msgstr ""
"Подключиться к Tarantool с помощью утилиты :ref:`tarantoolctl "
"<tarantoolctl>`, внимательно изучить статистику запросов с помощью "
":ref:`box.stat() <box_introspection-box_stat>` и выявить источник "
"потребления. Для этой цели могут оказаться полезными следующие команды:"

msgid ""
"-- checking the RPS of calling stored procedures\n"
"tarantool> box.stat().CALL.rps"
msgstr ""
"-- запрашиваем RPS для вызовов хранимых процедур\n"
"tarantool> box.stat().CALL.rps"

msgid ""
"The critical RPS value is 75 000, boiling down to 10 000 - 20 000 for a "
"rich Lua application (a Lua module of 200+ lines)."
msgstr ""
"Критическое значение RPS -- 75 000, в случае большого Lua-приложения "
"(модульного приложения, содержащего более 200 строк кода) -- 10 000 - 20 "
"000."

msgid ""
"-- checking RPS per query type\n"
"tarantool> box.stat().<query_type>.rps"
msgstr ""
"-- запрашиваем RPS для запросов указанного типа\n"
"tarantool> box.stat().<query_type>.rps"

msgid ""
"The critical RPS value for SELECT/INSERT/UPDATE/DELETE requests is 100 "
"000."
msgstr ""
"Критическое значение RPS для запросов типа SELECT/INSERT/UPDATE/DELETE --"
" 100 000."

msgid ""
"If the load is mostly generated by SELECT requests, we recommend adding a"
" :ref:`slave server <replication-bootstrap>` and let it process part of "
"the queries."
msgstr ""
"Если основная нагрузка генерируется SELECT-запросами, следует добавить "
":ref:`slave-сервер <replication-bootstrap>` и часть запросов обрабатывать"
"  на нем."

msgid ""
"If the load is mostly generated by INSERT/UPDATE/DELETE requests, we "
"recommend :ref:`sharding the database <shard-module>`."
msgstr ""
"Если же нагрузка по большей части приходится на "
"INSERT/UPDATE/DELETE-запросы, рекомендуется провести :ref:`шардинг базы "
"данных <shard-module>`."

msgid "Problem: Query processing times out"
msgstr "Проблема: обработка запросов прекращается по таймауту"

msgid ""
"All reasons that we discuss here can be identified by messages in "
"Tarantool's log file, all starting with the words ``'Too long...'``."
msgstr ""
"Все описанные ниже ситуации можно распознать по записям в журнале "
"Tarantool, начинающимся со слов ``'Too long...'``."

msgid ""
"Both fast and slow queries are processed within a single connection, so "
"the readahead buffer is cluttered with slow queries."
msgstr ""
"Быстрые и медленные запросы обрабатываются в одном подключении, что "
"приводит к забиванию readahead-буфера медленными запросами."

msgid ""
"Increase the readahead buffer size (:ref:`box.cfg{readahead} "
"<cfg_networking-readahead>` parameter)."
msgstr ""
"Увеличить размер readahead-буфера (:ref:`box.cfg{readahead} "
"<cfg_networking-readahead>`)."

msgid ""
"This parameter can be changed on the fly, so you don't need to restart "
"Tarantool. Attach to the Tarantool instance with :ref:`tarantoolctl "
"<tarantoolctl>` utility and call ``box.cfg{}`` with a new ``readahead`` "
"value:"
msgstr ""
"Перезапускать Tarantool при этом не требуется. Для обновления "
"конфигурации необходимо подключиться к Tarantool с помощью утилиты "
":ref:`tarantoolctl <tarantoolctl>` и передать в ``box.cfg{}`` новое "
"значение параметра ``readahead``:"

msgid ""
"-- changing the readahead value\n"
"tarantool> box.cfg{readahead = 10 * 1024 * 1024}"
msgstr ""
"-- задаем новое значение readahead\n"
"tarantool> box.cfg{readahead = 10 * 1024 * 1024}"

msgid ""
"**Example:** Given 1000 RPS, 1 Кbyte of query size, and 10 seconds of "
"maximal query processing time, the minimal readahead buffer size must be "
"10 Mbytes."
msgstr ""
"**Пример расчета:** при 1000 RPS, размере одного запроса в 1 Кбайт и "
"максимальном времени обработки одного запроса в 10 секунд минимальный "
"размер readahead-буфера должен равняться 10 Мбайт."

msgid ""
"On the business logic level, split fast and slow queries processing by "
"different connections."
msgstr ""
"Обрабатывать быстрые и медленные запросы в отдельных подключениях "
"(решается на уровне бизнес-логики)."

msgid "Slow disks."
msgstr "Медленная работа дисков."

msgid ""
"Check disk performance (use `iostat "
"<https://linux.die.net/man/1/iostat>`_, `iotop "
"<https://linux.die.net/man/1/iotop>`_ or `strace "
"<https://linux.die.net/man/1/strace>`_ utility to check ``iowait`` "
"parameter) and try to put .xlog files and snapshot files on different "
"physical disks (i.e. use different locations for :ref:`wal_dir "
"<cfg_basic-wal_dir>` and :ref:`memtx_dir <cfg_basic-memtx_dir>`)."
msgstr ""
"Проверить занятость дисков (с помощью утилиты `iostat "
"<https://linux.die.net/man/1/iostat>`_, `iotop "
"<https://linux.die.net/man/1/iotop>`_ или `strace "
"<https://linux.die.net/man/1/strace>`_ посмотреть на параметр ``iowait``)"
"  и попробовать разнести .xlog-файлы и снимки состояния базы данных по "
"разным дискам (т.е. указать разные значения для параметров  :ref:`wal_dir"
"  <cfg_basic-wal_dir>` и :ref:`memtx_dir <cfg_basic-memtx_dir>`)."

msgid "Problem: Replication \"lag\" and \"idle\" contain negative values"
msgstr "Проблема: параметры репликации lag и idle принимают отрицательные значения"

msgid ""
"This is about ``box.info.replication.(upstream.)lag`` and "
"``box.info.replication.(upstream.)idle`` values in "
":ref:`box.info.replication <box_info_replication>` section."
msgstr ""
"Речь идет о параметрах ``box.info.replication.(upstream.)lag`` и "
"``box.info.replication.(upstream.)idle`` из сводной таблицы "
":ref:`box.info.replication <box_info_replication>`."

msgid ""
"Operating system clock on the hosts is not synchronized, or the NTP "
"server is faulty."
msgstr "Не синхронизированы часы на машинах или  неправильно работает NTP-сервер."

msgid "Check NTP server settings."
msgstr "Проверить настройки NTP-сервера."

msgid ""
"If you found no problems with the NTP server, just do nothing then. Lag "
"calculation uses operating system clock from two different machines. If "
"they get out of sync, the remote master clock can get consistently behind"
" the local instance’s clock."
msgstr ""
"Если проблем с NTP-сервером не обнаружено, то не следует ничего "
"предпринимать, потому что при вычислении лага репликации используются "
"показания системных часов на двух разных машинах, и в случае "
"рассинхронизации может случиться так, что часы удаленного мастер-сервера "
"всегда будут отставать от часов локального экземпляра Tarantool."

msgid ""
"Problem: Replication \"idle\" keeps growing, but no related log messages "
"appear"
msgstr ""
"Проблема: значение параметра idle растет, но журнал не содержит связанных"
"  с этим сообщений"

msgid ""
"This is about ``box.info.replication.(upstream.)idle`` value in "
":ref:`box.info.replication <box_info_replication>` section."
msgstr ""
"Речь идет о параметре ``box.info.replication.(upstream.)idle`` из сводной"
"  таблицы :ref:`box.info.replication <box_info_replication>`."

msgid ""
"Some server was assigned different IP addresses, or some server was "
"specified twice in ``box.cfg{}``, so duplicate connections were "
"established."
msgstr ""
"Одному серверу были назначены различные IP-адреса или один и тот же "
"сервер был указан в ``box.cfg{}`` дважды, что привело к установлению "
"дублирующего подключения."

msgid ""
":ref:`Upgrade Tarantool 1.6 to 1.7 <admin-upgrades_instance>`, where this"
" error is fixed: in case of duplicate connections, replication is stopped"
" and the following message is added to the log: ``'Incorrect value for "
"option ''replication_source'': duplicate connection with the same replica"
" UUID'``."
msgstr ""
":ref:`Обновить Tarantool 1.6 до 1.7 <admin-upgrades_instance>`, где эта "
"ошибка была исправлена: в описанной ситуации репликация будет "
"остановлена, а в журнал будет записана следующая ошибка: ``'Incorrect "
"value for option ''replication_source'': duplicate connection with the "
"same replica UUID'``."

msgid "Problem: Replication statistics differ on replicas within a replica set"
msgstr ""
"Проблема: общие параметры репликации не совпадают на репликах в рамках "
"одного кластера"

msgid ""
"This is about a replica set that consists of one master and several "
"replicas. In a replica set of this type, values in "
":ref:`box.info.replication <box_info_replication>` section, like "
"``box.info.replication.lsn``, come from the master and must be the same "
"on all replicas within the replica set. The problem is that they get "
"different."
msgstr ""
"Речь идет о кластере, состоящем из одного мастера и нескольких реплик. В "
"таком случае значения общих параметров из сводной таблицы "
":ref:`box.info.replication <box_info_replication>`, например "
"``box.info.replication.lsn``, должны приходить с мастера и должны быть "
"одинаковыми на всех репликах. Если такие параметры не совпадают, это "
"свидетельствует о наличии проблем."

msgid "Replication is broken."
msgstr "Сбой репликации."

msgid ":ref:`Restart replication <replication-recover>`."
msgstr ":ref:`Перезапустить репликацию <replication-recover>`."

msgid "Problem: Master-master replication is stopped"
msgstr "Проблема: репликация мастер-мастер остановлена"

msgid ""
"This is about :ref:`box.info.replication(.upstream).status "
"<box_info_replication>` = stopped."
msgstr ""
"Речь идет о том, что параметр "
":ref:`box.info.replication(.upstream).status <box_info_replication>` "
"имеет значение stopped."

msgid ""
"In a master-master replica set of two Tarantool instances, one of the "
"masters has tried to perform an action already performed by the other "
"server, for example re-insert a tuple with the same unique key. This "
"would cause an error message like ``'Duplicate key exists in unique index"
" 'primary' in space <space_name>'``."
msgstr ""
"В репликационном кластере, состоящем из двух мастер-серверов, один из "
"серверов попытался выполнить действие, уже выполненное другим сервером, "
"-- например, повторно вставить кортеж с таким же уникальным ключом "
"(распознается по ошибке вида ``'Duplicate key exists in unique index "
"'primary' in space <space_name>'``)."

msgid "Restart replication with the following commands (at each master instance):"
msgstr ""
"Возобновить репликацию с помощью следующих команд (должны быть выполнены "
"на всех мастер-серверах):"

msgid ""
"-- restarting replication\n"
"tarantool> original_value = box.cfg.replication\n"
"tarantool> box.cfg{replication={}}\n"
"tarantool> box.cfg{replication=original_value}"
msgstr ""
"-- перезапускаем репликацию\n"
"tarantool> original_value = box.cfg.replication\n"
"tarantool> box.cfg{replication={}}\n"
"tarantool> box.cfg{replication=original_value}"

msgid ""
"We also recommend using text primary keys or setting up :ref:`master-"
"slave replication <replication-master_replica_bootstrap>`."
msgstr ""
"Также рекомендуется перейти на текстовые первичные ключи или настроить "
":ref:`репликацию мастер-реплика <replication-master_replica_bootstrap>`."

msgid "Problem: Tarantool works much slower than before"
msgstr "Проблема: Tarantool работает заметно медленнее, чем раньше"

msgid ""
"Inefficient memory usage (RAM is cluttered with a huge amount of unused "
"objects)."
msgstr ""
"Неэффективное использование памяти (память занята большим количеством "
"неиспользуемых объектов)."

msgid ""
"Call the Lua garbage collector with the `collectgarbage('count') function"
" <https://www.lua.org/manual/5.1/manual.html#pdf-collectgarbage>`_ and "
"measure its execution time with the Tarantool functions "
":ref:`clock.bench() <clock-bench>` or :ref:`clock.proc() <clock-proc>`."
msgstr ""
"Запустить сборщик мусора в Lua с помощью `функции collectgarbage(count) "
"<https://www.lua.org/manual/5.1/manual.html#pdf-collectgarbage>`_ и "
"измерить время ее выполнения с помощью :ref:`clock.bench() <clock-bench>`"
"  или :ref:`clock.proc() <clock-proc>`."

msgid "Example of calculating memory usage statistics:"
msgstr "Пример кода для подсчета потребляемой памяти:"

msgid ""
"-- loading Tarantool's \"clock\" module with time-related routines\n"
"tarantool> clock = require 'clock'\n"
"-- starting the timer\n"
"tarantool> b = clock.proc()\n"
"-- launching garbage collection\n"
"tarantool> c = collectgarbage('count')\n"
"-- stopping the timer after garbage collection is completed\n"
"tarantool> return c, clock.proc() - b"
msgstr ""
"-- загрузка модуля clock для работы со временем\n"
"tarantool> local clock = require 'clock'\n"
"-- запускаем таймер\n"
"tarantool> local b = clock.proc()\n"
"-- запускаем сборку мусора\n"
"tarantool> local c = collectgarbage('count')\n"
"-- останавливаем таймер по завершении сборки мусора\n"
"tarantool> return c, clock.proc() - b"

msgid ""
"If the returned ``clock.proc()`` value is greater than 0.001, this may be"
" an indicator of inefficient memory usage (no active measures are "
"required, but we recommend to optimize your Tarantool application code)."
msgstr ""
"Если возвращаемое ``clock.proc()`` значение больше 0.001, это может "
"являться признаком неэффективного использования памяти (активного "
"вмешательства не требуется, но рекомендуется оптимизация кода). Если "
"значение превышает 0.01, необходимо провести подробный анализ кода и "
"оптимизировать потребление памяти."

msgid ""
"If the value is greater than 0.01, your application definitely needs "
"thorough code analysis aimed at optimizing memory usage."
msgstr ""
"Если значение больше 0,01, код приложения однозначно необходимо "
"проанализировать на предмет оптимизации использования памяти."
