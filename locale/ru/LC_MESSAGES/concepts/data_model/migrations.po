
msgid "Migrations"
msgstr "Миграции"

msgid ""
"**Migration** refers to any change in a data schema: adding/removing a "
"field, creating/dropping an index, changing a field format, etc."
msgstr ""
"**Миграцией** называется любое изменение схемы данных: добавление/удаление "
"поля, добавление/удаление индекса, изменение формата поля и т. д."

msgid ""
"In Tarantool, there are two types of schema migration that do not require "
"data migration:"
msgstr ""
"В Tarantool есть только два вида миграции схемы, при которых не нужно "
"мигрировать данные:"

msgid "adding a field to the end of a space"
msgstr "добавление поля в конец спейса"

msgid "creating an index"
msgstr "добавление индекса"

msgid "Adding a field to the end of a space"
msgstr "Добавление поля в конец спейса"

msgid "You can add a field as follows:"
msgstr "Добавление поля происходит следующим образом:"

msgid ""
"local users = box.space.users\n"
"local fmt = users:format()\n"
"\n"
"table.insert(fmt, { name = 'age', type = 'number', is_nullable = true })\n"
"users:format(fmt)"
msgstr ""
"local users = box.space.users\n"
"local fmt = users:format()\n"
"\n"
"table.insert(fmt, { name = 'age', type = 'number', is_nullable = true })\n"
"users:format(fmt)"

msgid ""
"Note that the field must have the ``is_nullable`` parameter. Otherwise, an "
"error will occur."
msgstr ""
"Обратите внимание: поле обязательно должно иметь параметр ``is_nullable``. "
"Иначе произойдет ошибка."

msgid ""
"After creating a new field, you probably want to fill it with data. The "
"`tarantool/moonwalker <https://github.com/tarantool/moonwalker>`_ module is "
"useful for this task. The README file describes how to work with this "
"module."
msgstr ""
"После создания нового поля, вы, вероятно, захотите заполнить его данными.\n"
"Для этой задачи удобно использовать модуль `tarantool/moonwalker <https://github.com/tarantool/moonwalker>`_. В README есть описание того, как начать его использовать."

msgid "Creating an index"
msgstr "Добавление индекса"

msgid ""
"Index creation is described in the "
":doc:`/reference/reference_lua/box_space/create_index` method."
msgstr ""
"Про добавление индекса рассказывается в описании метода "
":doc:`/reference/reference_lua/box_space/create_index`."

msgid "Other types of migrations"
msgstr "Остальные виды миграций"

msgid ""
"Other types of migrations are also allowed, but it would be more difficult "
"to maintain data consistency."
msgstr ""
"Остальные виды миграций также возможны, однако поддерживать консистентность "
"данных при этом сложнее."

msgid "Migrations are possible in two cases:"
msgstr "Миграции можно выполнять в двух случаях:"

msgid "When Tarantool starts, and no client uses the database yet"
msgstr "при старте Tarantool, пока ни один клиент еще не использует БД"

msgid ""
"During request processing, when active clients are already using the "
"database"
msgstr "в процессе обработки запросов, когда у БД уже есть активные клиенты"

msgid ""
"For the first case, it is enough to write and test the migration code. The "
"most difficult task is to migrate data when there are active clients. You "
"should keep it in mind when you initially design the data schema."
msgstr ""
"Для первого случая достаточно кода миграции, который будет написан и "
"оттестирован. Самая сложная задача — это провести миграцию данных при "
"наличии активных клиентов. Это необходимо иметь в виду при начальном "
"проектировании схемы данных."

msgid "We identify the following problems if there are active clients:"
msgstr "Мы выделяем следующие проблемы при наличии активных клиентов:"

msgid "Associated data can change atomically."
msgstr "Связанные данные могут атомарно изменяться."

msgid ""
"The system should be able to transfer data using both the new schema and the"
" old one."
msgstr "Нужно уметь отдавать данные как по новой схеме, так и по старой."

msgid ""
"When data is being transferred to a new space, data access should consider "
"that the data might be in one space or another."
msgstr ""
"Когда данные перемещают в новый спейс, доступ к данным должен учитывать, что"
" данные могут быть как в одном спейсе, так и в другом."

msgid ""
"Write requests must not interfere with the migration. A common approach is "
"to write according to the new data schema."
msgstr ""
"Запросы на запись не должны мешать корректной миграции. Типичный подход: "
"всегда писать по новой схеме."

msgid ""
"These issues may or may not be relevant depending on your application and "
"its availability requirements."
msgstr ""
"Эти проблемы могут быть или не быть релевантными в зависимости от вашего "
"приложения и требований к его доступности."

msgid "What you need to know when writing complex migrations"
msgstr "Что нужно знать при написании сложных миграций"

msgid ""
"Tarantool has a transaction mechanism. It is useful when writing a "
"migration, because it allows you to work with the data atomically. But "
"before using the transaction mechanism, you should explore its limitations."
msgstr ""
"В Tarantool есть механизм транзакций. Он полезен при написании миграции, так"
" как позволяет атомарно работать с данными. Но перед использованием "
"механизма транзакций нужно знать об ограничениях."

msgid ""
"For details, see the section about :doc:`transactions </book/box/atomic>`."
msgstr ""
"Подробнее о них описано в разделе про :doc:`транзакции </book/box/atomic>`."

msgid "How you can apply migration"
msgstr "Как применять миграции"

msgid ""
"The migration code is executed on a running Tarantool instance. Important: "
"no method guarantees you transactional application of migrations on the "
"whole cluster."
msgstr ""
"Код миграций исполняется на запущенном инстансе Tarantool. Важно: ни один "
"способ не гарантирует вам транзакционное применение миграций на всем "
"кластере."

msgid "**Method 1**: include migrations in the application code"
msgstr "**Способ 1**: написать миграции в коде основного приложения"

msgid ""
"This is quite simple: when you reload the code, the data is migrated at the "
"right moment, and the database schema is updated. However, this method may "
"not work for everyone. You may not be able to restart Tarantool or update "
"the code using the hot-reload mechanism."
msgstr ""
"Это довольно просто: когда вы перезагружаете код, в нужный момент происходит"
" миграция данных и схема базы данных обновляется. Однако такой способ может "
"подойти не всем. У вас может не быть возможности перезапустить Tarantool или"
" обновить код через механизм горячей перезагрузки (hot reload)."

msgid ""
"**Method 2**: tarantool/migrations (only for a Tarantool Cartridge cluster)"
msgstr ""
"**Способ 2**: tarantool/migrations (только для кластера на Tarantool "
"Cartridge)"

msgid ""
"This method is described in the README file of the `tarantool/migrations "
"<https://github.com/tarantool/migrations>`_ module."
msgstr ""
"Про этот способ подробнее написано в README самого модуля "
"`tarantool/migrations <https://github.com/tarantool/migrations>`_."

msgid ""
"There are also two other methods that we **do not recommend**, but you may "
"find them useful for one reason or another."
msgstr ""
"Есть также два способа, которые мы **не рекомендуем использовать**, но вы "
"можете найти их полезными по тем или иным причинам."

msgid "**Method 3**: the ``tarantoolctl`` utility"
msgstr "**Cпособ 3**: утилита ``tarantoolctl``"

msgid ""
"The ``tarantoolctl`` utility ships with Tarantool. Connect to the necessary "
"instance using ``tarantoolctl connect``."
msgstr ""
"Утилита ``tarantoolctl`` поставляется вместе с Tarantool. Подключитесь к "
"нужному инстансу через команду ``tarantoolctl connect``."

msgid "$ tarantoolctl connect admin:password@localhost:3301"
msgstr "$ tarantoolctl connect admin:password@localhost:3301"

msgid ""
"If your migration is written in a Lua file, you can execute it using "
"``dofile()``. Call this function and specify the path to the migration file "
"as the first argument. It looks like this:"
msgstr ""
"Если ваша миграция написана в Lua файле, вы можете исполнить его с помощью "
"функции ``dofile()``. Вызовите ее и первым аргументом укажите путь до файла "
"с миграцией. Выглядит это вот так:"

msgid ""
"tarantool> dofile('0001-delete-space.lua')\n"
"---\n"
"..."
msgstr ""
"tarantool> dofile('0001-delete-space.lua')\n"
"---\n"
"..."

msgid ""
"(or) Copy the migration script code, paste it into the console, and run it."
msgstr ""
"(или) можно скопировать код скрипта миграции, вставить его в консоль и "
"применить."

msgid "**Method 4**: applying migration with Ansible"
msgstr "**Способ 4**: применение миграции с помощью Ansible"

msgid ""
"If you use the `Ansible role  <https://github.com/tarantool/ansible-"
"cartridge>`_ to deploy a Tarantool cluster, you can use ``eval``. You can "
"find more information about it `in the Ansible role documentation "
"<https://github.com/tarantool/ansible-cartridge/blob/master/doc/eval.md>`_."
msgstr ""
"Если вы используете `Ansible-роль для развёртывания кластера Tarantool "
"<https://github.com/tarantool/ansible-cartridge>`_, то вы можете применить "
"``eval``. Прочитать подробнее про ``eval`` можно `в документации по Ansible-"
"роли <https://github.com/tarantool/ansible-"
"cartridge/blob/master/doc/eval.md>`_."
